{% extends 'base.html' %}
{% block contenido %}
<h2>Nueva Orden de Trabajo</h2>
<form method="POST">
    <label>Productor:</label>
    <select name="productor_id" required>
        {% for p in productores %}
        <option value="{{ p[0] }}">{{ p[1] }}</option>
        {% endfor %}
    </select><br>

    <label>Campo y lote:</label>
    <select name="lote_id">
    {% for l in lotes %}
    <option value="{{ l[0] }}">{{ l[2] }} → Lote {{ l[1] }}</option>
    {% endfor %}
    </select>

    <label>Fecha estimada:</label>
    <input type="date" name="fecha" required><br>

    <label>Hectáreas estimadas:</label>
    <input type="number" step="0.01" name="hectareas" required><br>

    <h3>Productos aplicados</h3>
<div id="productos">
    <div class="producto-item">
        <input type="text" name="producto[]" placeholder="Producto">
        <select name="unidad[]">
            <option value="litros">Litros</option>
            <option value="gramos">Gramos</option>
        </select>
        <input type="number" step="0.01" name="cantidad[]" placeholder="Cantidad/ha">
    </div>
</div>
<button type="button" onclick="agregarProducto()">➕ Agregar producto</button>


    <button type="submit">Guardar orden</button>
</form>

<script>
function agregarProducto() {
    const div = document.createElement('div');
    div.innerHTML = `
        <input type="text" name="producto[]" placeholder="Producto">
        <select name="unidad[]">
            <option value="litros">Litros</option>
            <option value="gramos">Gramos</option>
        </select>
        <input type="number" step="0.01" name="cantidad[]" placeholder="Cantidad/ha">
    `;
    document.getElementById('productos').appendChild(div);
}
</script>
{% endblock %}
